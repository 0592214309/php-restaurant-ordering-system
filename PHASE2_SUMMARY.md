# Phase 2 Complete - Authentication System

## What I implemented in Phase 2

1. Users table (schema provided in `database/restaurant_phase2.sql`)
   - Fields: `user_id`, `full_name`, `email`, `phone`, `password_hash`, `role`, `created_at`, `is_active`
   - Roles supported: `customer`, `admin`, `staff`

2. Registration
   - `auth/register.php`: user-friendly registration form
   - Validates input, checks for existing email, hashes password with `password_hash()`
   - Redirects to login on success

3. Login / Logout
   - `auth/login.php`: login form with email + password
   - Verifies password with `password_verify()`, sets session variables
   - `auth/logout.php`: destroys session and redirects to homepage

4. Session Verification
   - `auth/verify.php`: include on protected pages to require login

5. Place Order (updated)
   - `customer/place_order.php`: requires login via `auth/verify.php`
   - Stores `user_id` on orders and uses logged-in user name

6. Navigation
   - `includes/navbar.php`: dynamic links (Login/Register for guests; My Orders, Profile, Logout for logged-in users)
   - Updated to show user's full name

7. Profile & Password Change
   - `customer/profile.php`: view user info and change password securely

8. Order History
   - `customer/my_orders.php`: shows logged-in user's orders, status, and totals

9. Admin Login (stub)
   - `auth/admin_login.php`: admin login page stub; redirects to `admin/index.php` (admin pages to be implemented next)

10. Tests updated
    - `test.php`: now checks `users` table and looks for a sample admin user

11. CSS updates
    - `assets/css/style.css` updated to include navbar styles and responsive behavior for Phase 2

## How to test Phase 2 (quick steps)

1. Ensure the `restaurant` database has the latest schema. If you have not yet imported `database/restaurant_phase2.sql`, do it now using phpMyAdmin.

2. Register a new user:
   - Open: http://localhost/restaurant/auth/register.php
   - Fill details and submit

3. Login as the new user:
   - Open: http://localhost/restaurant/auth/login.php
   - After login you will be redirected to the homepage; navbar will show "My Orders" and "Profile"

4. Place an order:
   - Open: http://localhost/restaurant/place_order.php or use the "Place Order" flow
   - Fill delivery phone and quantities, submit
   - Check `orders` and `order_items` tables in phpMyAdmin

5. View order history:
   - Open: http://localhost/restaurant/customer/my_orders.php

6. Change password:
   - Open: http://localhost/restaurant/customer/profile.php
   - Use the password change form

7. Run quick tests:
   - Open: http://localhost/restaurant/test.php
   - Look for Phase 2 checks in the output

## Notes & Recommendations

- For admin access, create a user via phpMyAdmin with `role='admin'` and a password hash generated by PHP (`password_hash()`). Example SQL (run in PHP or generate hash in a small script):

  INSERT INTO users (full_name, email, phone, password_hash, role) VALUES ('Admin User','admin@restaurant.com','0240000000','<password_hash_here>','admin');

- Next steps (Phase 3): implement Admin dashboard, menu management (CRUD), and image uploads.

- Security: we use prepared statements and password hashing. Later phases should add CSRF tokens, stronger validation, and rate-limiting for logins.

---

All Phase 2 files are committed. If you want, I can now:
- Implement admin dashboard (Phase 3)
- Add email/password reset via token
- Improve UI (icons, images)

Which would you like next?